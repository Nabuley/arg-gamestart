
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARG game</title>
</head>
<body>
    <h1>the start</h1>
    <button onclick="setHintCookie()">단서 얻기</button>
    <p id="hintMessage">단서가 없습니다.</p>

    <script>
        async function setHintCookie() {
            const secretKey = "value";
            // const encoder = new TextEncoder();
            // const hashBuffer = await crypto.subtle.digest("SHA-256", encoder.encode(secretKey));
            // const hashArray = Array.from(new Uint8Array(hashBuffer));
            // const hashHex = hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
            // const encodedValue = btoa(hashHex);
            
            document.cookie = `access_granted=${secretKey}; path=/; max-age=3600; SameSite=None; Secure`;

            console.log("쿠키 설정됨:", document.cookie);
            alert("You are not admin");
        }
        
        async function verifyCookie() {
            const secretKey = "TheAnswer";
            const encoder = new TextEncoder();
            const hashBuffer = await crypto.subtle.digest("SHA-256", encoder.encode(secretKey));
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
            const returnval = btoa(secretKey);
            const encodedValue = "value";

            const cookies = document.cookie.split("; ").map(cookie => cookie.split("="));
            const accessCookie = cookies.find(cookie => cookie[0] === "admin");

            const hintMessage = document.getElementById("hintMessage");
            if (accessCookie && accessCookie[1] === encodedValue) {
                hintMessage.innerHTML = returnval;
            } else {
                hintMessage.innerHTML = "You are not admin";
                alert("You are not admin");
            }
        }

        window.onload = function() {
            verifyCookie();
        }
    </script>
</body>
</html>
